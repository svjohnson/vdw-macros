1                                                          The SAS System                           13:14 Tuesday, December 16, 2008

NOTE: Unable to open SASUSER.REGSTRY. WORK.REGSTRY will be opened instead.
NOTE: All registry changes will be lost at the end of the session.

NOTE: Copyright (c) 2002-2003 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) 9.1 (TS1M3)
      Licensed to GROUP HEALTH COOPERATIVE OF PUGET SOUND, Site 0009688001.
NOTE: This session is executing on the XP_PRO  platform.



NOTE: SAS 9.1.3 Service Pack 4

NOTE: SAS initialization used:
      real time           10.15 seconds
      cpu time            0.93 seconds
      
1          /*********************************************
2          * Roy Pardee
3          * Center For Health Studies
4          * (206) 287-2078
5          * pardee.r@ghc.org
6          *
7          * \\groups\data\CTRHS\Crn\S D R C\VDW\Macros\test_make_inclusion_table.sas
8          *
9          * <<purpose>>
10         *********************************************/
11         
12         /* This is managed in the login script so that it doesnt
13            actually try to login when the machine is not connected
14            to the network */
15         %include "\\home\pardre1\SAS\Scripts\dw_login.sas" ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           0.00 seconds
      cpu time            0.00 seconds
      

NOTE: Remote signon to CHSDWSAS commencing (SAS Release 9.01.01M3P020206).
NOTE: Script file 'tcpwin.scr' entered.
NOTE: Logged onto Windows... Starting remote SAS now.
NOTE: SAS/CONNECT conversation established.
NOTE: Unable to open SASUSER.PROFILE. WORK.PROFILE will be opened instead.
NOTE: All profile changes will be lost at the end of the session.
NOTE: Copyright (c) 2002-2003 by SAS Institute Inc., Cary, NC, USA. 
NOTE: SAS (r) 9.1 (TS1M3)
      Licensed to GROUP HEALTH COOPERATIVE OF PUGET SOUND, Site 0009688002.
NOTE: This session is executing on the NET_SRV  platform.



NOTE: SAS 9.1.3 Service Pack 4

NOTE: SAS initialization used:
      real time           0.26 seconds
      cpu time            0.12 seconds
      
NOTE: Remote signon to CHSDWSAS complete.
2                                        The SAS System         13:14 Tuesday, December 16, 2008

NOTE: Remote submit to CHSDWSAS commencing.
1    ***********************;
2    * Set the typical libnames... ;
3    %let DWROOT = \\ctrhs-sas\warehouse\SasData\ ;
4    libname consumer  "&DWROOT.Consumer" ;
NOTE: Libref CONSUMER was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Consumer
5    libname chsid     "&DWROOT.CHSID" ;
NOTE: Libref CHSID was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\CHSID
6    libname demogs    "&DWROOT.Consumer Demographics" ;
NOTE: Libref DEMOGS was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Consumer Demographics
7    libname enroll    "&DWROOT.Enrollment" ;
NOTE: Libref ENROLL was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Enrollment
8    libname nac       "&DWROOT.Cancer\Naaccr" ;
NOTE: Libref NAC was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Cancer\Naaccr
9    libname naaccr    "&DWROOT.Cancer\Naaccr" ;
NOTE: Libname NAACCR refers to the same physical library as NAC.
NOTE: Libref NAACCR was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Cancer\Naaccr
10   libname baseline  "&DWROOT.Baseline" ;
NOTE: Libref BASELINE was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Baseline
11   libname arpa      "&DWROOT.arpa" ;
NOTE: Libref ARPA was successfully assigned as follows: 
      Engine:        V9 
3                                        The SAS System         13:14 Tuesday, December 16, 2008

      Physical Name: \\ctrhs-sas\warehouse\SasData\arpa
12   libname mbhist    "&DWROOT.mbhist" ;
NOTE: Libref MBHIST was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\mbhist
13   libname mbcurr    "&DWROOT.mbcurr" ;
NOTE: Libref MBCURR was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\mbcurr
14   libname claims    "&DWROOT.claims" ;
NOTE: Libref CLAIMS was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\claims
15   libname death     "&DWROOT.death" ;
NOTE: Libref DEATH was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\death
16   libname hosp      "&DWROOT.Hospital" ;
NOTE: Libref HOSP was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Hospital
17   libname VDW       "&DWROOT.CRN_VDW" ;
NOTE: Libref VDW was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\CRN_VDW
18   libname hosps     "&DWROOT.hospital" ;
NOTE: Libname HOSPS refers to the same physical library as HOSP.
NOTE: Libref HOSPS was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\Hospital
19   libname rx        "&DWROOT.rx" ;
NOTE: Libref RX was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\rx
20   libname lab       "&DWROOT.lab" ;
NOTE: Libref LAB was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\lab
21   libname s         "\\ctrhs-sas\sasuser\pardre1" ;
NOTE: Libref S was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\sasuser\pardre1
22   
23   footnote "Program file: &CurrFile " ;
24   
25   
26   options linesize = 150 nocenter msglevel = i NOOVP formchar='|-++++++++++=|-/|<>*' 
dsoptions="note2err" ;
27   
28   %include "\\groups\data\CTRHS\Crn\S D R C\VDW\Macros\StdVars.sas" ;
NOTE: Libname __VDW refers to the same physical library as VDW.
NOTE: Libref __VDW was successfully assigned as follows: 
      Engine:        V9 
4                                        The SAS System         13:14 Tuesday, December 16, 2008

      Physical Name: \\ctrhs-sas\warehouse\SasData\CRN_VDW
115  filename crn_macs  FTP     "CRN_VDW_MACROS.sas"
116                     HOST  = "centerforhealthstudies.org"
117                     CD    = "/CRNSAS"
118                     PASS  = XXXXXXXXXXXXXXX
119                     USER  = "CRNReader" ;
120  
121  %include crn_macs ;
NOTE: 220 chsorg2 Microsoft FTP Service (Version 5.0).
NOTE: User CRNReader has connected to FTP server  on Host centerforhealthstudies.org .
4334  
4335  %include "\\groups\data\CTRHS\Crn\S D R C\VDW\Macros\make_inclusion_table.sas" ;
4469  
4470  %macro make_test_cohort ;
4471    proc sql outobs = 10000 nowarn ;
4472      create table s.test_cohort as
4473      select mrn
4474      from vdw.demog
4475      where substr(mrn, 4, 1) = 'G'
4476      ;
4477    quit ;
4478  %mend ;
4479  
4480  %*make_test_cohort ;
4481  
4482  ods html path = "\\groups\data\CTRHS\Crn\S D R C\VDW\Macros\" (URL=NONE)
4483           body = "test_make_inclusion_table.html"
4484           (title = "test_make_inclusion_table output")
4485            ;
NOTE: Writing HTML Body file: test_make_inclusion_table.html
4486  
4487  
4488  options mprint ;
4489  %make_inclusion_table(cohort = s.test_cohort) ;
MPRINT(MAKE_INCLUSION_TABLE):   libname __d "\\ctrhs-sas\warehouse\sasdata\crn_vdw" access = 
readonly ;
NOTE: Libname __D refers to the same physical library as __VDW.
NOTE: Libref __D was successfully assigned as follows: 
      Engine:        V9 
      Physical Name: \\ctrhs-sas\warehouse\SasData\CRN_VDW
MPRINT(MAKE_INCLUSION_TABLE):   proc format ;
MPRINT(MAKE_INCLUSION_TABLE):   value $Hispani 'Y' = '1 Hispanic or Latino' 'N' = '2 Not 
Hispanic or Latino' ' ' , '' , Missing = '3 Unknown 
(Individuals not reporting ethnicity)' ;
NOTE: Format $HISPANI has been output.
MPRINT(MAKE_INCLUSION_TABLE):   value $Gender 'M' = 'Males' 'F' = 'Females' Other = 'Unknown or 
Not Reported' ;
NOTE: Format $GENDER has been output.
MPRINT(MAKE_INCLUSION_TABLE):   value $Race '01' = '5 White' '02' = '4 Black or African 
American' '03' = '1 American Indian/Alaska Native' '04' , 
'05' , '06' , '08' , '09' , '10' , '11' , '12' , '13' , '14' , '96' = '2 Asian' '07' , '20' , 
'21' , '22' , '25' , '26' , '27' , '28' , '30' , '31' , 
'32' , '97' = '3 Native Hawaiian or Other Pacific Islander' '-1' = '6 More than one race' Other 
5                                        The SAS System         13:14 Tuesday, December 16, 2008

= '7 Unknown or Not Reported' ;
NOTE: Format $RACE has been output.
MPRINT(MAKE_INCLUSION_TABLE):   quit ;

NOTE: PROCEDURE FORMAT used (Total process time):
      real time           0.03 seconds
      cpu time            0.03 seconds
      

MPRINT(MAKE_INCLUSION_TABLE):   * TODO: the macro should check for the presence of gender, 
race1 and hispanic, and only pull them if necessary. ;
MPRINT(MAKE_INCLUSION_TABLE):   proc sql ;
MPRINT(MAKE_INCLUSION_TABLE):   create table _reportable as select d.mrn, d.race1 as race label 
= "Racial Category" , d.hispanic label = "Ethnic 
Category" , d.gender label = "Sex/Gender" from __d.demog as d INNER JOIN s.test_cohort as c on 
d.mrn = c.mrn ;
INFO: Index mrn of SQL table __D.DEMOG (alias = D) selected for SQL WHERE clause (join) 
optimization.
NOTE: Table WORK._REPORTABLE created, with 10000 rows and 4 columns.

MPRINT(MAKE_INCLUSION_TABLE):   create table genders (gender char(1)) ;
NOTE: Table WORK.GENDERS created, with 0 rows and 1 columns.
MPRINT(MAKE_INCLUSION_TABLE):   insert into genders(gender) values ('F') ;
NOTE: 1 row was inserted into WORK.GENDERS.

MPRINT(MAKE_INCLUSION_TABLE):   insert into genders(gender) values ('M') ;
NOTE: 1 row was inserted into WORK.GENDERS.

MPRINT(MAKE_INCLUSION_TABLE):   insert into genders(gender) values ('U') ;
NOTE: 1 row was inserted into WORK.GENDERS.

MPRINT(MAKE_INCLUSION_TABLE):   create table races(race char(2)) ;
NOTE: Table WORK.RACES created, with 0 rows and 1 columns.
MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('01') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('02') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('03') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('04') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('  ') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('97') ;
NOTE: 1 row was inserted into WORK.RACES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into races(race) values ('-1') ;
NOTE: 1 row was inserted into WORK.RACES.
6                                        The SAS System         13:14 Tuesday, December 16, 2008


MPRINT(MAKE_INCLUSION_TABLE):   create table ethnicities(hispanic char(1)) ;
NOTE: Table WORK.ETHNICITIES created, with 0 rows and 1 columns.
MPRINT(MAKE_INCLUSION_TABLE):   insert into ethnicities(hispanic) values('Y') ;
NOTE: 1 row was inserted into WORK.ETHNICITIES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into ethnicities(hispanic) values('N') ;
NOTE: 1 row was inserted into WORK.ETHNICITIES.

MPRINT(MAKE_INCLUSION_TABLE):   insert into ethnicities(hispanic) values(' ') ;
NOTE: 1 row was inserted into WORK.ETHNICITIES.

MPRINT(MAKE_INCLUSION_TABLE):   create table class_levels as select gender, race, hispanic from 
genders CROSS JOIN races CROSS JOIN ethnicities ;
NOTE: The execution of this query involves performing one or more Cartesian product joins that 
can not be optimized.
NOTE: Table WORK.CLASS_LEVELS created, with 63 rows and 3 columns.

MPRINT(MAKE_INCLUSION_TABLE):   quit ;
NOTE: PROCEDURE SQL used (Total process time):
      real time           1.35 seconds
      cpu time            0.39 seconds
      

MPRINT(MAKE_INCLUSION_TABLE):   title1 "Inclusion Enrollment Report" ;
MPRINT(MAKE_INCLUSION_TABLE):   title2 "PART A TOTAL ENROLLMENT REPORT" ;
MPRINT(MAKE_INCLUSION_TABLE):   proc tabulate data = _reportable missing format = comma15.0 
order = formatted classdata = class_levels ;
MPRINT(MAKE_INCLUSION_TABLE):   class hispanic race gender ;
MPRINT(MAKE_INCLUSION_TABLE):   keylabel N = ' ' ;
MPRINT(MAKE_INCLUSION_TABLE):   tables hispanic all='Total of all subjects:', gender all = 
'Total' / printmiss misstext = '0' box = 'Ethnic Category' 
;
MPRINT(MAKE_INCLUSION_TABLE):   tables race all='Total of all subjects:', gender all = 'Total' 
/ printmiss misstext = '0' box = 'Racial Categories' ;
MPRINT(MAKE_INCLUSION_TABLE):   format race $race. hispanic $hispani. gender $gender. ;
MPRINT(MAKE_INCLUSION_TABLE):   quit ;

NOTE: Multiple concurrent threads will be used to summarize data.
NOTE: There were 10000 observations read from the data set WORK._REPORTABLE.
NOTE: There were 63 observations read from the data set WORK.CLASS_LEVELS.
NOTE: The PROCEDURE TABULATE printed pages 1-2.
NOTE: PROCEDURE TABULATE used (Total process time):
      real time           0.46 seconds
      cpu time            0.25 seconds
      

MPRINT(MAKE_INCLUSION_TABLE):   title2 "PART B HISPANIC ENROLLMENT REPORT" ;
MPRINT(MAKE_INCLUSION_TABLE):   proc tabulate data = _reportable missing format = comma15.0 
order = formatted classdata = class_levels ;
MPRINT(MAKE_INCLUSION_TABLE):   class hispanic race gender ;
MPRINT(MAKE_INCLUSION_TABLE):   keylabel N = ' ' ;
MPRINT(MAKE_INCLUSION_TABLE):   tables race all='Total of Hispanics or Latinos:', gender all = 
7                                        The SAS System         13:14 Tuesday, December 16, 2008

'Total' / printmiss misstext = '0' box = 'Racial 
Categories' ;
MPRINT(MAKE_INCLUSION_TABLE):   format race $race. hispanic $hispani. gender $gender. ;
MPRINT(MAKE_INCLUSION_TABLE):   where put(hispanic, $hispani.) = '1 Hispanic or Latino' ;
MPRINT(MAKE_INCLUSION_TABLE):   quit ;

NOTE: Multiple concurrent threads will be used to summarize data.
NOTE: There were 25 observations read from the data set WORK._REPORTABLE.
      WHERE PUT(hispanic, $HISPANI47.)='1 Hispanic or Latino';
NOTE: There were 21 observations read from the data set WORK.CLASS_LEVELS.
      WHERE PUT(hispanic, $HISPANI47.)='1 Hispanic or Latino';
NOTE: The PROCEDURE TABULATE printed page 3.
NOTE: PROCEDURE TABULATE used (Total process time):
      real time           0.34 seconds
      cpu time            0.23 seconds
      

MPRINT(MAKE_INCLUSION_TABLE):   libname __d clear ;
NOTE: Libref __D has been deassigned.
4490  
4491  run ;
4492  ods html close ;
NOTE: Remote submit to CHSDWSAS complete.
NOTE: SAS Institute Inc., SAS Campus Drive, Cary, NC USA 27513-2414
NOTE: The SAS System used:
      real time           23.33 seconds
      cpu time            1.53 seconds
      
